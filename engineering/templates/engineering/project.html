{% extends "engineering/layout.html" %}
{% load humanize %}

{% block body %}
    <div class='container'>
        <h1><strong>{{ projectName }}</strong></h1>

        {% if projDetails %}
        <table class="table" id="projectTable">
            <thead class="thead-dark">
            <tr>
                <th><strong>#</strong></th>
                <th><strong>Description</strong></th>
                <th><strong>Quantity</strong></th>
                <th><strong>Price</strong></th>
                <th><strong>Total Amount</strong></th>
                <th><strong>Action</strong></th>
            </tr>
            </thead>
            <tbody>
                {% for detail in projDetails %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td><div contenteditable="true">{{ detail.description }}</div></td>
                    <td><div contenteditable="true" oninput="updateRowTotal(this)">{{ detail.quantity }}</div></td>
                    <td><div contenteditable="true" oninput="updateRowTotal(this)">{{ detail.price }}</div></td>
                    <td><div contenteditable="false">{{ detail.total_price|floatformat:"2"|intcomma }}</div></td>
                    <td><span onclick="deleteRow(this)" class="delete-icon">&#10060;</span></td>
                </tr>
                {% endfor %}
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="4" align="right"><strong>Total:</strong></td>
                    <td>{{ total_amount_sum|floatformat:"2"|intcomma }}</td>
                </tr>
            </tfoot>
        </table>
        <button onclick="addRow()">Add Row</button>
        <button onclick="undoDelete()">Undo</button>

        {% else %}
        <table class="table" id="projectTable">
            <thead class="thead-dark">
            <tr>
                <th><strong>#</strong></th>
                <th><strong>Description</strong></th>
                <th><strong>Quantity</strong></th>
                <th><strong>Price</strong></th>
                <th><strong>Total Amount</strong></th>
                <th><strong>Action</strong></th>
            </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td><div contenteditable="true">Description</div></td>
                    <td><div contenteditable="true" oninput="updateRowTotal(this)">Quantity</div></td>
                    <td><div contenteditable="true" oninput="updateRowTotal(this)">Price</div></td>
                    <td><div contenteditable="false"></div></td>
                    <td><span onclick="deleteRow(this)" class="delete-icon">&#10060;</span></td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="4" align="right"><strong>Total:</strong></td>
                    <td>{{ total_amount_sum|floatformat:"2"|intcomma }}</td>
                </tr>
            </tfoot>
        </table>
        <button onclick="addRow()">Add Row</button>
        <button onclick="undoDelete()">Undo</button>
        {% endif %}
    </div>

{% endblock %}
